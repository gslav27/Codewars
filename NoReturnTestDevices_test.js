const references = [{
  type: 'RZCBT-19',
  voltages: [12.72, 8.07, 8.34, 1.29, 5.63, 9.46],
  ranges: [1.5, 0.1, 0.5, 0.1, 1.5, 3],
},
{
  type: 'YNAOZ-54',
  voltages: [10.75, 2.01, 1.98, 5.52, 9.67, 8.67, 9.76],
  ranges: [1.5, 1.5, 3, 0.5, 0.1, 0.3, 0.5],
},
{
  type: 'TSKWG-77',
  voltages: [6.28, 1.15, 9.49, 1.84, 7.83, 7.97, 11.59, 2.94, 9.57],
  ranges: [3, 1.5, 1.5, 1.5, 1.5, 1, 0.3, 3, 0.3],
},
{
  type: 'XDZXN-22',
  voltages: [1.07, 9.87, 2.87, 3.33, 4.27, 1.77, 5.38, 3.28, 2.33],
  ranges: [0.1, 1, 0.3, 0.5, 3, 1, 0.1, 1.5, 0.3],
},
{
  type: 'VJVHX-45',
  voltages: [11.92, 7.26, 11.35, 6.45, 12.98, 1.49, 4.64, 2.98, 10.63, 3.45],
  ranges: [3, 3, 1.5, 0.1, 0.5, 1, 0.5, 1, 0.3, 1.5],
},
{
  type: 'JGMRJ-9',
  voltages: [5.94, 7.19, 11.19, 11.85, 4.67, 10.61, 7.85, 7.04, 8.5],
  ranges: [0.3, 0.5, 3, 0.5, 1, 1.5, 1, 1.5, 3],
},
{
  type: 'MMCTV-51',
  voltages: [5.02, 3.45, 12.17],
  ranges: [1, 1.5, 1],
},
{
  type: 'SHZLO-17',
  voltages: [7.29, 7.27, 6.98, 12.42, 8.8, 3.95, 7.92, 4.72],
  ranges: [0.5, 1, 3, 0.1, 3, 1, 0.1, 1],
},
{
  type: 'NKCLL-78',
  voltages: [9.41, 7.54, 5.13, 7.81, 6.16, 4.56, 4.92, 12.97, 4.31, 7.85],
  ranges: [0.1, 3, 0.1, 1.5, 0.3, 1.5, 3, 1.5, 0.5, 0.1],
},
{
  type: 'OROLS-69',
  voltages: [7.74, 9.6, 3.27, 9.82, 5.59, 12.3, 10.8, 4, 2.06],
  ranges: [0.5, 0.3, 1.5, 3, 0.5, 0.1, 1, 0.5, 1],
},
{
  type: 'IXPUT-94',
  voltages: [8.78, 3.5, 10.59, 6.25, 10.46, 1.98, 8.28],
  ranges: [0.3, 0.1, 0.1, 1, 0.1, 1.5, 0.3],
},
{
  type: 'DKHMC-60',
  voltages: [1.49, 11.72, 1.74, 2.64, 4.83, 4.85, 3.71],
  ranges: [1.5, 1, 3, 1.5, 0.3, 0.3, 0.1],
},
{
  type: 'RTJRO-39',
  voltages: [11.35, 1.33, 10.98, 11.25, 9.09, 10.02, 11.99, 6.56],
  ranges: [1.5, 0.5, 3, 0.1, 0.1, 1.5, 0.5, 1.5],
},
{
  type: 'VIAOI-67',
  voltages: [10.9, 6.84, 4.32, 7.16, 1.18, 2.66],
  ranges: [0.3, 0.3, 0.1, 1, 1, 0.1],
},
{
  type: 'YKUKA-9',
  voltages: [10.44, 5.17, 8.95, 2.45, 7.94],
  ranges: [0.1, 1.5, 0.3, 0.1, 3],
},
{
  type: 'JESKQ-88',
  voltages: [8.67, 1.99, 12.26, 10.13, 6.51, 7.2, 3.95],
  ranges: [1, 0.5, 1, 1.5, 0.1, 1, 1],
},
{
  type: 'ACEOL-33',
  voltages: [11.24, 5.98, 12.88, 12.64, 11.68, 11.53],
  ranges: [0.1, 0.1, 1.5, 0.5, 0.1, 0.3],
},
{
  type: 'FXUYJ-40',
  voltages: [10.06, 2.46, 2.35, 9.52, 3.4, 5.3, 6.95, 11.85, 4.39],
  ranges: [0.5, 0.1, 0.3, 0.3, 1, 0.3, 0.5, 0.1, 1],
},
{
  type: 'GGSWT-95',
  voltages: [5.05, 7.03, 6.26],
  ranges: [3, 0.1, 3],
},
{
  type: 'VNLUS-66',
  voltages: [9.27, 3.74, 9.72, 5.29, 7.99, 9.58],
  ranges: [0.5, 1, 1, 0.1, 3, 0.3],
},
{
  type: 'SPILG-82',
  voltages: [12.49, 5.97, 5.71, 7.9, 12.97, 3.32, 7.76],
  ranges: [1.5, 3, 0.1, 0.5, 0.5, 3, 1],
},
{
  type: 'DUOTT-20',
  voltages: [6.08, 5.53, 9.57, 7.57, 4.81, 6.86, 8.83, 6.94, 3.83],
  ranges: [3, 1.5, 0.1, 1.5, 1, 0.5, 0.3, 0.5, 0.5],
},
{
  type: 'MNZOD-45',
  voltages: [6.43, 2.16, 12.74, 8.78, 7.73, 9.08, 3.51, 3.85, 2.58],
  ranges: [1.5, 1.5, 0.5, 0.1, 0.1, 0.5, 0.3, 0.5, 0.3],
},
{
  type: 'ASVZA-98',
  voltages: [12.91, 8.64, 6.59],
  ranges: [0.5, 3, 0.5],
},
{
  type: 'ZQVWI-90',
  voltages: [1.52, 5.83, 12.47],
  ranges: [3, 0.5, 1],
},
{
  type: 'MDEWM-72',
  voltages: [2.72, 7.51, 12.08, 2.26, 11.57, 2.73, 8.71, 12.57],
  ranges: [3, 0.5, 0.5, 3, 0.1, 0.5, 3, 3],
},
{
  type: 'CWTGM-4',
  voltages: [9.8, 2.71, 11.7, 3.78, 12.41, 5.79, 11.87],
  ranges: [0.5, 0.1, 3, 1, 0.5, 0.5, 0.3],
},
{
  type: 'UBJPG-73',
  voltages: [4.3, 3.91, 9.19, 12.44, 5.26, 8.25],
  ranges: [0.5, 1.5, 0.3, 0.1, 0.1, 1],
},
{
  type: 'AGXOB-3',
  voltages: [10.91, 5.26, 7.13, 2.09, 6.45, 8.82, 7.29, 9.64],
  ranges: [1.5, 1, 0.5, 3, 1.5, 0.1, 1.5, 1],
},
{
  type: 'SYFBZ-86',
  voltages: [6.25, 8.8, 12.37],
  ranges: [1.5, 3, 0.1],
},
{
  type: 'NNOSU-18',
  voltages: [3.38, 6.1, 4.96, 3.64, 8.47, 11.86],
  ranges: [3, 1, 0.1, 1, 0.3, 1],
},
{
  type: 'RUGZZ-39',
  voltages: [6.56, 1.74, 12.74],
  ranges: [1, 0.1, 0.5],
},
{
  type: 'KQWIF-38',
  voltages: [7.79, 4.01, 6.35, 10.07, 5.21, 9.81],
  ranges: [1.5, 1.5, 0.3, 0.1, 1, 0.3],
},
{
  type: 'AYOXI-93',
  voltages: [9.67, 11.88, 7.12, 1.99, 1.82, 5.19],
  ranges: [0.1, 0.1, 0.5, 1, 1, 3],
},
{
  type: 'FACBU-6',
  voltages: [5.72, 1.93, 5.38, 10.94, 9.81],
  ranges: [1, 0.5, 3, 1.5, 1.5],
},
{
  type: 'GGGVC-5',
  voltages: [4.28, 4.59, 4.35, 8.55, 4.73, 8.05, 11.19],
  ranges: [0.5, 0.5, 1.5, 1.5, 1, 3, 0.5],
},
{
  type: 'SVKFW-84',
  voltages: [6.2, 6.29, 2.18, 7.88, 11.71, 4.34, 12.18, 11.4, 12.94, 5.41],
  ranges: [3, 0.1, 0.5, 0.1, 0.5, 0.1, 1.5, 0.1, 0.1, 0.3],
},
{
  type: 'JBGEP-94',
  voltages: [4.07, 1.03, 10.64, 5.75, 11.23],
  ranges: [1, 1, 1.5, 1.5, 0.1],
},
{
  type: 'LHYRR-64',
  voltages: [10.09, 9.53, 5.38, 9.45, 8.82],
  ranges: [1, 3, 0.1, 0.3, 0.3],
},
{
  type: 'HXCWJ-14',
  voltages: [11.83, 4.92, 6.82, 11.98, 2.52],
  ranges: [1, 3, 3, 3, 0.5],
},
{
  type: 'SDKNV-15',
  voltages: [2.87, 13, 5.58, 2.23],
  ranges: [0.3, 0.1, 1.5, 0.5],
},
{
  type: 'XACYT-39',
  voltages: [12.93, 7.04, 4.92, 2.57, 12.91, 6.88],
  ranges: [0.3, 3, 1, 1.5, 1.5, 0.3],
},
{
  type: 'TDLHK-91',
  voltages: [5.08, 7.14, 6.88],
  ranges: [0.1, 1, 0.5],
},
{
  type: 'AROLM-56',
  voltages: [4.73, 12.55, 9.45, 10.67],
  ranges: [1.5, 0.3, 0.3, 0.3],
},
{
  type: 'WLRNM-68',
  voltages: [1.05, 8.37, 1.47, 1.16, 2.11],
  ranges: [1, 1.5, 0.3, 3, 1.5],
},
{
  type: 'SJFWS-46',
  voltages: [3.58, 1.3, 12.15, 11.27, 1.49],
  ranges: [3, 0.5, 0.1, 1, 0.5],
},
{
  type: 'ZTBOO-51',
  voltages: [8.19, 10.27, 8.41, 7.15, 7.87],
  ranges: [0.3, 3, 1.5, 0.3, 1.5],
},
{
  type: 'FXONT-95',
  voltages: [10.41, 2.01, 2.31, 5.3, 10.44],
  ranges: [0.5, 0.3, 1.5, 0.1, 0.1],
},
{
  type: 'QWZGB-45',
  voltages: [9.36, 4.47, 5.09, 8.48, 2.62, 12.72, 4.9, 3.82],
  ranges: [1.5, 0.5, 3, 1.5, 0.3, 1, 0.1, 0.1],
},
{
  type: 'KDYAO-14',
  voltages: [9.64, 3.83, 12.56, 6.81, 12.59, 3.17, 5.19, 8.22, 1],
  ranges: [1, 1.5, 0.3, 0.3, 0.1, 0.3, 0.5, 0.5, 0.1],
},
{
  type: 'RUPQX-89',
  voltages: [10.84, 9.36, 6.83, 5.96],
  ranges: [1.5, 1, 0.5, 0.3],
},
{
  type: 'ZSCTN-43',
  voltages: [10.96, 11.94, 10.3, 4.39, 8.29, 8.21],
  ranges: [1.5, 3, 1.5, 1.5, 1.5, 0.5],
},
{
  type: 'BIOJL-65',
  voltages: [11.4, 1.15, 1.23, 5.3, 12.74, 2.3, 4.53, 2.25, 11.42],
  ranges: [1.5, 0.3, 0.1, 0.3, 1, 1, 0.5, 1.5, 1],
},
{
  type: 'WCBCD-40',
  voltages: [2.91, 1.68, 2.29, 11.55, 6.9, 3.63, 10.76, 3.31],
  ranges: [0.3, 1, 1, 1, 0.1, 0.3, 1.5, 3],
},
{
  type: 'JJLXS-61',
  voltages: [7.87, 7.51, 9.74, 5.22, 7.09, 4.63],
  ranges: [1.5, 0.5, 0.3, 3, 0.5, 1],
},
{
  type: 'FGFKB-66',
  voltages: [6.32, 2.35, 7.17, 2.38, 6.69, 5.24, 4.08, 9.92, 6.62],
  ranges: [3, 1.5, 0.3, 0.5, 1, 1.5, 1, 1, 1.5],
},
{
  type: 'GYNKF-39',
  voltages: [6.67, 12.16, 8.26, 12.07, 10.74, 4.44, 2.02, 4.43],
  ranges: [0.5, 0.5, 0.5, 1.5, 0.5, 3, 0.3, 1.5],
},
{
  type: 'QOKYJ-60',
  voltages: [6.3, 4.75, 6.79, 8.11, 12.79, 8.73, 2.39, 6.06, 10.38, 12.13],
  ranges: [3, 0.3, 0.5, 0.1, 1, 1.5, 1, 1, 3, 0.5],
},
{
  type: 'AFRDH-98',
  voltages: [3.58, 11.72, 10.74, 4.31, 11.75, 1.31, 10.17, 6.09, 3.14],
  ranges: [0.5, 0.1, 0.1, 1.5, 0.5, 1, 3, 0.1, 3],
},
{
  type: 'ZKTQO-96',
  voltages: [2.36, 2.18, 7.1, 6.27, 5.51, 11.3, 1.56, 12.33],
  ranges: [3, 0.5, 0.1, 0.3, 0.5, 0.1, 0.3, 0.5],
},
{
  type: 'SOIOP-45',
  voltages: [4.88, 12.81, 6.16, 5.19, 11.95, 12.5],
  ranges: [1.5, 1, 0.3, 1.5, 1.5, 3],
},
{
  type: 'ATZRN-26',
  voltages: [7.93, 3.77, 12.47],
  ranges: [1.5, 1, 1.5],
},
{
  type: 'DWDHG-89',
  voltages: [10.95, 2.67, 9.42, 7.22],
  ranges: [0.1, 0.1, 1, 0.1],
},
{
  type: 'TWURP-40',
  voltages: [11.14, 6.06, 12.95, 5.44, 3.23, 1.59, 3.49, 6.78, 12.25],
  ranges: [1, 0.3, 0.3, 3, 0.3, 1, 1.5, 0.5, 1.5],
}];

const scanner = devices => (
  devices
    .map(
      device => (
        device.voltages
          .reduce((acc, v, ind, arr, kpi = references.find(({ type }) => type === device.type)) => (
            (v >= kpi.voltages[ind] * (1 - kpi.ranges[ind] / 100)) && (v <= kpi.voltages[ind] * (1 + kpi.ranges[ind] / 100))
              ? acc
              : [...acc, ind]
          ), [])
      ),
    )
    .reduce((acc, val, i) => (
      val.length
        ? [acc[0], ++acc[1], [...acc[2], [i, ...val]]]
        : [++acc[0], ...acc.slice(1)]
    ), [0, 0, []])
    .reduce((acc, val, i) => (
      (i === 0)
        ? `Good: ${val}`
        : (i === 1)
          ? `${acc}, faulty: ${val}`
          : `${acc}, positions: ${val.length ? val.map(err => `${err[0]}[${err.slice(1).join(',')}]`).join(';') : 'none'}`
    ), '')
);

// const exampleInput = [
//   {
//     type: 'RZCBT-19',
//     voltages: [12.72, 8.07, 8.34, 1.29, 5.63, 9.46],
//   },
//   {
//     type: 'YNAOZ-54',
//     voltages: [10.75, 3, 1.98, 4, 9.67, 8.67, 9.76],
//   },
// ];
const exampleInput = [
  {
    type: 'RZCBT-19',
    voltages:
      [12.571041134600742,
        8.082925837756246,
        8.377234701848131,
        1.288860023201456,
        5.566639877050452,
        9.257199292374862],
  },
  {
    type: 'SHZLO-17',
    voltages:
        [7.262461191168139,
          7.328601580207669,
          7.131440305673008,
          12.409110556813332,
          8.607980193552052,
          3.983828001932015,
          7.925999009958772,
          4.798059812171694],
  },
  {
    type: 'DUOTT-20',
    voltages: [6.08, 5.53, 9.57, 7.57, 4.81, 6.86, 8.83, 6.94, 3.83],
  },
  {
    type: 'SJFWS-46',
    voltages:
        [3.656775607310722,
          1.2943829753153562,
          12.160462783170122,
          11.18663971550946,
          1.4834653618944684],
  },
];

console.log(scanner(exampleInput));
